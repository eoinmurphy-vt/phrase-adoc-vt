= Test_ZweiBerichterstattung & Benachrichtigungen
:revdate: 2025-05-02
:page-revdate: {revdate}
:page-opendocs-origin: /07.reporting/01.reporting/01.reporting.md
:page-opendocs-slug:  /berichterstattung/berichterstattung

== Test_TwoReporting

Berichte können aus mehreren Menüs in der \{product-name} Konsole angezeigt und heruntergeladen werden. Das Dashboard zeigt eine Sicherheitszusammenfassung an, die als PDF heruntergeladen werden kann. Der PDF-Download kann bei Bedarf nach einem Namensraum gefiltert werden.

image:3_0_Dashboard.png[Dashboard]

Die Ergebnisse der Schwachstellenscans und der CIS-Benchmark für Registrierungen, Container, Knoten und Plattformen können ebenfalls als CSV-Dateien aus den jeweiligen Menüs in den Abschnitten des Vermögensmenüs heruntergeladen werden.

Das Menü Sicherheitsrisiken bietet erweiterte Korrelation, Filterung und Berichterstattung für Schwachstellen und Compliance-Prüfungen. Gefilterte Ansichten können im CSV- oder PDF-Format exportiert werden.

image:security_risks_4.png[Berichte]

Compliance-Berichte für PCI, HIPAA, GDPR und andere Vorschriften können gefiltert, angezeigt und exportiert werden, indem die Vorschrift im Popup für erweiterte Filter in Sicherheitsrisiken -> Compliance ausgewählt wird.

image:gdpr_report.png[Berichte]

=== Test_ZweiEreignisberichterstattung

Alle Ereignisse wie Sicherheit, Verwaltung, Zulassung, Scannen und Risiko werden von \{product-name} protokolliert und können auch in der Konsole im Menü Benachrichtigungen angezeigt werden. Siehe unten für Details.

==== Test_TwoEvent Limits

Alle Ereignisse werden im Speicher gespeichert, um sie im Dashboard und in den Benachrichtigungsbildschirmen anzuzeigen. Es wird erwartet, dass Ereignisse über SYSLOG, Webhook oder andere Mittel gesendet werden, um von einem SIEM-System gespeichert und verwaltet zu werden. Derzeit gibt es eine 4K-Grenze für jeden Ereignistyp unten:

* Risikoberichte (Scannen, gefunden in Benachrichtigungen -> Risikoberichte)
* Allgemeine Ereignisse (Verwaltung, gefunden in den Benachrichtigungen -> Ereignisse)
* Verstöße (Netzwerkverstöße, gefunden in den Benachrichtigungen -> Sicherheitsereignisse)
* Bedrohungen (Netzwerkangriffe und Verbindungsprobleme, gefunden in den Benachrichtigungen -> Sicherheitsereignisse)
* Vorfälle (Prozess- und Datei-Verstöße, gefunden in den Benachrichtigungen -> Sicherheitsereignisse)

Deshalb werden, sobald das Limit erreicht ist, nur die aktuellsten 4K Ereignisse dieses Typs angezeigt. Dies betrifft sowohl die Benachrichtigungsliste als auch die Anzeigen im Dashboard.

== Test_TwoSIEM und SYSLOG

Sie können den SYSLOG-Server und die Webhook-Benachrichtigungen im \{product-name} Konsolenmenü unter Einstellungen -> Konfiguration konfigurieren. Wählen Sie das Protokollierungsniveau, TCP oder UDP, und das Format, wenn JSON gewünscht ist. CVE-Daten können einzeln für jede CVE gesendet werden und/oder geschichtete Scanergebnisse enthalten. Sie können auch wählen, Ereignisse an das Pod-Protokoll des Controllers zu senden, anstatt oder zusätzlich zu Syslog. Beachten Sie, dass Ereignisse nur an das Pod-Protokoll des Hauptcontrollers gesendet werden.

Sie können dann Ihre bevorzugten Reporting-Tools verwenden, um \{product-name} Ereignisse zu überwachen.

Darüber hinaus können Sie Ihren Syslog-Server über die CLI wie folgt konfigurieren:

[,shell]
----
> set system syslog_server <ip>[:port]
----

Die REST-API kann ebenfalls zur Konfiguration verwendet werden.

=== Test_TwoSample SYSLOG Output

==== Test_TwoNetwork Violation

[,shell]
----
2020-01-24T21:39:34Z neuvector-controller-pod-575f94dccf-rccmt /usr/local/bin/controller 12 neuvector - notification=violation,level=Warning,reported_timestamp=1579901965,reported_at=2020-01-24T21:39:25Z,cluster_name=cluster.local,client_id=edf1c28d3411a9686e6e0374a9325b6a3626619938d3cf435a9d90075a1ef653,client_name=k8s_POD_node-pod-7c57bdbf5d-dxkn4_default_cdd9cf23-488d-439c-9408-ed98f838c67b_0,client_domain=default,client_image=k8s.gcr.io/pause:3.1,client_service=node-pod.default,server_id=external,server_name=external,server_port=80,ip_proto=6,applications=[HTTP],servers=[],sessions=1,policy_action=violate,policy_id=0,client_ip=192.168.35.69,server_ip=172.217.5.110
----

==== Test_TwoProzessverstoß

[,shell]
----
2020-01-24T21:39:29Z neuvector-controller-pod-575f94dccf-rccmt /usr/local/bin/controller 12 neuvector - notification=incident,name=Process.Profile.Violation,level=Warning,reported_timestamp=1579901965,reported_at=2020-01-24T21:39:25Z,cluster_name=cluster.local,host_id=k43:HF45:AJC6:5RYO:O5OA:KACD:KRT2:M3O6:P3VQ:IC4I:FSRD:P3HJ:ETLS,host_name=k43,enforcer_id=90822bad25eea14180c0942bf30197528bdab8c8237f307cc3059e6bbdb91f7a,enforcer_name=k8s_neuvector-enforcer-pod_neuvector-enforcer-pod-cg8jp_neuvector_d4ef187e-041c-4bc2-9cdc-c563a3feac6c_0,workload_id=d1be6d14f1f2782029d0944040ea8c0ba581991de99df86041205e15abc80209,workload_name=k8s_node-pod_node-pod-7c57bdbf5d-dxkn4_default_cdd9cf23-488d-439c-9408-ed98f838c67b_0,workload_domain=default,workload_image=nvbeta/node:latest,workload_service=node-pod.default,proc_name=curl,proc_path=/usr/bin/curl,proc_cmd=curl google.com,proc_effective_uid=1000,proc_effective_user=neuvector,client_ip=,server_ip=,client_port=0,server_port=0,server_conn_port=0,ether_type=0,ip_proto=0,conn_ingress=false,proc_parent_name=docker-runc,proc_parent_path=/usr/bin/docker-runc,action=violate,group=nv.node-pod.default,aggregation_from=1579901965,count=1,message=Process profile violation
----

==== Test_TwoAdmission Control

[,shell]
----
2020-01-24T21:48:31Z neuvector-controller-pod-575f94dccf-rccmt /usr/local/bin/controller 12 neuvector - notification=audit,name=Admission.Control.Violation,level=Warning,reported_timestamp=1579902506,reported_at=2020-01-24T21:48:26Z,cluster_name=cluster.local,host_id=,host_name=,enforcer_id=,enforcer_name=,workload_domain=default,workload_image=nvbeta/swarm_nginx,base_os=,high_vul_cnt=0,medium_vul_cnt=0,cvedb_version=,message=Creation of Kubernetes ReplicaSet resource (nginx-pod-695cd4b87b) violates Admission Control deny rule id 1000 but is allowed in monitor mode [Notice: the requested image(s) are not scanned: nvbeta/swarm_nginx],user=kubernetes-admin,error=,aggregation_from=1579902506,count=1,platform=,platform_version=
----

Um SYSLOG-Ausgaben zu erfassen:

[,bash]
----
nc -l -p 8514 -o syslog-dump.hex | tee syslog-messages.txt
----

Erfasst Nachrichten auf dem Bildschirm, protokolliert sie in eine Datei und erstellt einen Hexdump.

=== Test_TwoIntegration mit Splunk

Sie können mit Splunk über SYSLOG integrieren, um Sicherheitsereignisse von Containern zu erfassen und in Splunk zu berichten.

== Test_TwoBenachrichtigungen und Protokolle

Im \{product-name} Console im Menü Benachrichtigungen finden Sie Benachrichtigungen für Sicherheitsereignisse, Risiko (Scanning & Compliance) Ereignisse und allgemeine Systemereignisse.

Benachrichtigungen können als CSV oder PDF aus den Menüs Benachrichtigungen heruntergeladen werden. Darüber hinaus können Paketaufzeichnungen für Netzwerkangriffe heruntergeladen werden, und die Ergebnisse von Schwachstellen können aus dem Menü Benachrichtigungen -> Risikoberichte für jedes Scanergebnis heruntergeladen werden.

Sie können die Protokolle auch über die CLI oder die REST-API anzeigen.

=== Test_TwoSecurity Events

Verstöße sind Verbindungen, die die Whitelist-Regeln verletzen oder einer Blacklist-Regel entsprechen. Netzwerkverstöße werden erfasst und Quell-IP-Adressen können weiter untersucht werden. Whitelist-Netzwerkverletzungsereignisse erscheinen als "Implizite Ablehnungsregel wurde verletzt", um anzuzeigen, dass die Netzwerkverbindung keiner Whitelist-Regel entsprach.

image:Security_Events321.png[Ereignisse]

In dieser Ansicht können Sie Netzwerk-, Prozess- und Dateiereignisse überprüfen und ganz einfach eine Whitelist-Regel für falsch-positive Ergebnisse hinzufügen, indem Sie auf die Schaltfläche Regel überprüfen klicken. Der erweiterte Filter ermöglicht es Ihnen, den Typ des anzuzeigenden Ereignisses auszuwählen.

image:security_events_addrule.png[AddRule]

\{product-name} überwacht auch kontinuierlich alle Container auf bekannte Angriffe wie DNS, DDoS, HTTP-Smuggling, Tunneling usw. Wenn ein Angriff erkannt wird, wird er hier protokolliert und blockiert (wenn der Container/Dienst zum Schutz eingestellt ist), und das Paket wird automatisch erfasst. Sie können die Paketdetails anzeigen, zum Beispiel:

image:ping_capture.png[Erfassen]

==== Test_ZweiNeue Regeln für Sicherheitsereignisse

Sie können ganz einfach Regeln (Sicherheitsrichtlinie) hinzufügen, um das erkannte Ereignis zuzulassen oder abzulehnen, indem Sie die Schaltfläche Regel überprüfen und eine neue Regel bereitstellen.

image:security_events_review.png[ReviewRule]

Dies ist nützlich, wenn falsche Positivmeldungen auftreten oder ein Netzwerk-/Prozessverhalten entdeckt werden sollte, aber während des Entdeckungsmodus nicht aufgetreten ist.

==== Test_ZweiErweiterte Filter

Erstellen Sie einen erweiterten Filter, um Ereignisse anzuzeigen oder zu exportieren, indem Sie jeden allgemeinen Typ auswählen oder Schlüsselwörter eingeben.

* Network. Netzereignisse wie Verstöße (implizite Ablehnungsregeln), Bedrohungen.
* Prozess. Verstöße gegen die Prozess-Whitelist oder verdächtige Prozesse, die erkannt wurden, wie NMAP, SSH usw.
* Paket. Ein Paket wurde im Container aktualisiert oder installiert, was ein Sicherheitsereignis ausgelöst hat.
* Tunnel. Ein Tunnelverstoß wurde erkannt. Tunneling, typischerweise wird DNS-Tunneling verwendet, um Daten zu stehlen. Diese Erkennung erfolgt, indem ein Tunnelprozess gestartet und mit einer Netzwerkaktivität mit dem DNS-Protokoll korreliert wird. Siehe Beispielereignis unten.  Beschreibung des Iodine-Tunnels https://github.com/yarrick/iodine
* Datei. Verstoß gegen den Datei-Zugriff. Entweder wurde auf eine überwachte sensible Datei/Verzeichnis zugegriffen (siehe Liste der Standardüberwachung) oder eine benutzerdefinierte Dateiüberwachungsregel wurde ausgelöst. Bitte beachten Sie die xref:./filerules.adoc[Dateizugriffsregeln] Seite für weitere Informationen.
* Berechtigung. Eine Berechtigungseskalation wurde im Container oder Host erkannt. Berechtigungseskalationen können auf viele Arten durchgeführt werden und sind nicht zu 100 % nachweisbar, sodass dies eine schwierige Bedingung zum Testen ist.

=== Test_TwoRisk Reports

Dieser Abschnitt enthält Ereignisse für Schwachstellenscans (Bild, Registry, Laufzeit, Container, Host, Plattform), Compliance-Scans (CIS-Benchmarks, benutzerdefinierte Skripte) und Ereignisse zur Zulassungskontrolle (erlaubt, verweigert).

== Test_TwoAndere Integrationen

\{product-name} hat einen Prometheus-Exporter mit Grafana-Dashboard auf dem \{product-name} GitHub-Konto https://github.com/neuvector/prometheus-exporter veröffentlicht, der für jede Installation angepasst werden kann.  Darüber hinaus sind auch Beispielintegrationen mit Fluentd auf Anfrage verfügbar.

Webhook-Benachrichtigungen können durch Konfigurieren des Webhook-Endpunkts in den Einstellungen -> Konfiguration gesendet werden. Erstellen Sie dann die entsprechenden Antwortregel(n) im Menü Richtlinie -> Antwortregeln, um den Ereignistyp und den Webhook als Aktion auszuwählen.
