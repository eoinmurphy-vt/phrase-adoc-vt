= Navigation dans la console
:revdate: 2024-09-27
:page-revdate: {revdate}
:page-opendocs-origin: /04.navigation/01.navigation/01.navigation.md
:page-opendocs-slug:  /navigation/navigation

== Accès à la console

L'utilisateur et le mot de passe par défaut sont admin.

Veuillez consulter la première section Principes de base -> Connect to Manager pour connaître les options de configuration telles que la désactivation de https, l'accès à la console via un pare-feu d'entreprise qui n'autorise pas le port 8443, ou le remplacement du certificat auto-signé.

== Menus et navigation

Utilisez le menu de gauche pour naviguer dans votre console {product-name}. Notez qu'il y a des paramètres supplémentaires en haut à droite pour le profil de l'utilisateur et la configuration multi-clusters.

image:4-3_Network_Activity.png[Navigation]

== Tableau de bord

Le tableau de bord présente un résumé des scores de risque, des événements de sécurité et des protocoles d'application détectés par {product-name}. Il indique également les détails de certains de ces événements de sécurité. Le tableau de bord permet de générer des rapports PDF contenant des graphiques et des explications détaillés.

En haut du tableau de bord figure un résumé des risques de sécurité dans le cluster. La clé à molette située à côté de la note de risque globale peut être cliquée pour ouvrir un assistant qui vous guidera dans les étapes recommandées pour réduire/améliorer la note de risque. En passant la souris sur chaque indicateur de risque, vous obtiendrez une description de celui-ci à droite, ainsi que la manière d'améliorer le score de risque. Voir également la section de la documentation séparée intitulée Améliorer le score de risque de sécurité.

image:Dashboard_Risks.png[Risques]

* Score global de risque de sécurité. Il s'agit d'un résumé pondéré des différents domaines de risque résumés à droite, y compris l'exposition aux services, l'exposition aux entrées et sorties et les risques liés à l'exploitation des vulnérabilités. Cliquez sur la clé pour améliorer le score.
* Score de risque d'exposition aux services. Il s'agit d'un indicateur du nombre de services protégés par des règles de liste blanche et fonctionnant en mode "surveillance" ou "protection", où le risque est le plus faible. Un taux élevé de services en mode découverte signifie que ces services ne sont pas segmentés ou isolés par des règles de liste blanche.
* Score de risque d'entrée et de sortie. Il s'agit d'un résumé pondéré des menaces réelles ou des violations du réseau détectées sur les connexions d'entrée ou de sortie (hors du cluster), combinées aux connexions d'entrée/de sortie autorisées. Les connexions externes protégées par des règles de liste blanche présentent un risque plus faible, mais peuvent toujours faire l'objet d'attaques par des réseaux intégrés. Remarque : Une liste des adresses IP d'entrée et de sortie peut être téléchargée à partir de la section des détails d'entrée et de sortie sous la forme d'un rapport d'exposition.
* Score de risque d'exploitation de la vulnérabilité. Il s'agit du risque d'exploitation des vulnérabilités dans les conteneurs en cours d'exécution. Les services en mode découverte présentant des vulnérabilités de haute criticité auront l'impact le plus élevé sur le score, étant donné qu'ils présentent le risque le plus élevé. Si des services sont en mode "surveillance" ou "protection" mais présentent encore des vulnérabilités élevées, ils sont protégés par des règles de réseau et de processus visant à identifier (et à bloquer) les activités suspectes, ce qui leur confère une pondération moindre sur le score. Un avertissement s'affiche si le bouton Auto-Scan n'est pas activé pour le balayage automatique en cours d'exécution.

Certains graphiques sont interactifs, comme le montrent les flèches vertes ci-dessous.

image:Dashboard-Click.png[Tableau de bord]

Certaines des données d'événements affichées dans le tableau de bord sont soumises à des limites, comme décrit dans la section Rapports.

Protocoles d'application détectés Ce tableau résume les protocoles d'application détectés dans les connexions en direct dans le cluster. La catégorie '`Other`' désigne tous les protocoles HTTP non reconnus ou les connexions TCP brutes. Vous pouvez basculer entre les niveaux Couverture de l'application et Volume de l'application.

* La couverture de l'application est le nombre de conversations uniques de pod à pod détectées entre les services d'application. Par exemple, si le module de service A se connecte au module de service B en utilisant HTTP, il s'agit d'un HTTP unique '`conversation`', mais toutes les connexions entre A et B comptent pour une conversation.
* Le volume de l'application est l'activité du réseau mesurée en Gbytes pour tous les services utilisant ce protocole.

=== Activité du réseau

Il s'agit d'une carte graphique de vos conteneurs et des conversations entre les conteneurs. Il indique également les connexions avec d'autres ressources locales et externes. Dans les modes Surveillance et Protection, les violations sont affichées avec des lignes rouges ou jaunes pour indiquer qu'une violation a été détectée.

[NOTE]
====
Si un grand nombre de conteneurs ou de services sont présents, la vue passe automatiquement à une vue de l'espace de noms (réduite). Double-cliquez sur l'icône d'un espace de noms pour le développer.
====

[NOTE]
====
Cet affichage utilise un GPU local s'il est disponible pour accélérer les temps de chargement. Certains GPU Windows ont des problèmes connus, et l'utilisation du GPU peut être désactivée dans la fenêtre du filtre avancé (voir ci-dessous pour les outils).
====

Voici quelques-unes des actions possibles :

* Déplacer les objets pour mieux visualiser les services et les conversations
* Cliquez sur une ligne (flèche) pour obtenir plus de détails tels que le protocole/port, le dernier horodatage et pour ajouter ou modifier une règle (REMARQUE : les deux points d'extrémité de la connexion doivent être entièrement développés en double-cliquant sur chacun d'entre eux afin de voir les détails de la connexion).
* Cliquez sur n'importe quel conteneur pour en voir les détails, et sur '`i`' pour les connexions en temps réel. Vous pouvez également mettre un nœud en quarantaine à partir d'ici. Cliquez avec le bouton droit de la souris sur un conteneur pour effectuer des actions.
* Filtrer l'affichage par protocole, ou rechercher par espace de noms, groupe, conteneur (en haut à droite). Vous pouvez ajouter plusieurs filtres à la boîte de sélection.
* Actualiser la carte pour afficher les dernières conversations
* Zoom avant/arrière pour passer d'une vue logique (tous les conteneurs regroupés dans un groupe de services) à une vue physique (tous les conteneurs du même service affichés).
* Activer/désactiver l'affichage des composants d'orchestration tels que les équilibreurs de charge (par exemple, intégrés pour Kubernetes ou Swarm).
* (Icône Service Mesh) Double-cliquez pour développer un pod dans un service mesh tel que Istio/Linkerd2 afin d'afficher les conteneurs sidecar et workload à l'intérieur du pod.

Le menu Outils, en haut à gauche, propose les fonctions suivantes, de gauche à droite :

* Zoom avant/arrière
* Réinitialiser l'affichage des icônes (si vous les avez déplacées)
* Ouvrez la fenêtre des filtres avancés (les filtres sont conservés pour la session de connexion de l'utilisateur).
* Afficher/masquer la légende
* Faire une capture d'écran
* Actualiser l'affichage de l'activité du réseau

image:4-3_NA_tools.png[Outils]

Un clic droit sur un conteneur permet d'afficher les actions suivantes :

image:4-3_NA_Actions.png[Actions]

Vous pouvez afficher les sessions actives, lancer des enregistrements de capture de paquets et mettre en quarantaine à partir d'ici. Vous pouvez également modifier ici le mode de protection global du service (tous les conteneurs de ce service). Les options d'expansion et de réduction vous permettent de simplifier ou d'étendre les objets.

L'affichage des données de la carte peut prendre quelques secondes après l'activité du réseau.

Voir l'explication des icônes de légende au bas de cette page.

=== Actifs

Assets affiche des informations sur les plateformes, les nœuds, les conteneurs, les registres, les vérificateurs Sigstore (utilisés dans les règles de contrôle d'admission) et les composants du système ({product-name} Controllers, Scanners et Enforcers).

{product-name} comprend une plateforme de gestion des vulnérabilités de bout en bout qui peut être intégrée à votre processus automatisé CI/CD. Recherche de vulnérabilités dans les registres, les images, les conteneurs en cours d'exécution et les nœuds hôtes. Les résultats pour les registres, les nœuds et les conteneurs individuels sont disponibles ici, tandis que les résultats combinés et les rapports avancés sont disponibles dans le menu Risques de sécurité.

{product-name} exécute également automatiquement le rapport de sécurité Docker Bench et Kubernetes CIS Benchmark (le cas échéant) sur chaque hôte et conteneurs en cours d'exécution.

Notez que l'état de tous les conteneurs est affiché dans Assets -> Containers, qui indique le mode de protection {product-name} (Discover, Monitor, Protect). Si le conteneur est affiché dans l'état "Exit", il est toujours sur l'hôte mais il est arrêté. Le retrait du conteneur le fait sortir de l'état de sortie.

Veuillez consulter la section Analyse et conformité pour plus de détails, notamment sur la manière d'utiliser le plug-in Jenkins {product-name} Vulnerability Scanner.

=== Politique

Cette fonction permet d'afficher et de gérer la politique de sécurité d'exécution qui détermine le comportement des applications de réseau, de processus et de système de fichiers du conteneur qui est AUTORISÉ et REFUSÉ. Toutes les conversations et activités qui ne sont pas explicitement autorisées sont enregistrées comme des violations par {product-name}. C'est également à ce niveau que les règles de contrôle d'admission peuvent être créées.

Veuillez consulter la section Politique de sécurité de cette documentation pour une explication détaillée du comportement des règles et de la manière de les modifier ou de les créer.

=== Risques pour la sécurité

Cela permet de personnaliser les enquêtes, le triage et les rapports sur la gestion des vulnérabilités et de la conformité. Recherchez facilement les vulnérabilités des images et découvrez quels nœuds ou conteneurs contiennent ces vulnérabilités. Le filtrage avancé facilite l'examen des résultats des analyses et des contrôles de conformité et fournit des rapports personnalisés.

Ces menus combinent les résultats des analyses de vulnérabilité des registres (images), des nœuds et des conteneurs, ainsi que des contrôles de conformité, afin de permettre une gestion des vulnérabilités et l'établissement de rapports de bout en bout.

=== Notifications

C'est là que vous pouvez voir les journaux des événements de sécurité, des rapports sur les risques (par exemple, l'analyse) et des événements généraux. {product-name} prend également en charge SYSLOG pour l'intégration avec des outils tels que SPLUNK, ainsi que les notifications webhook.

*Événements liés à la sécurité*

Utilisez la recherche ou le filtre avancé pour localiser des événements spécifiques. Le widget chronologique situé en haut peut également être ajusté à l'aide des cercles de gauche et de droite pour modifier la fenêtre temporelle. Vous pouvez également ajouter facilement des règles (politique de sécurité) pour autoriser ou refuser l'événement détecté en sélectionnant le bouton Réviser la règle et en déployant une nouvelle règle.

{product-name} surveille en permanence tous les conteneurs pour détecter les attaques connues telles que DNS, DDoS, HTTP-smuggling, tunneling, etc. Lorsqu'une attaque est détectée, elle est enregistrée ici et bloquée (si le conteneur/service est configuré pour être protégé), et le paquet est automatiquement capturé. Vous pouvez consulter les détails du paquet, par exemple :

image:ping-capture.png[Capture]

*La règle de refus implicite est violée*

Les violations sont des connexions qui enfreignent les règles de la liste blanche ou qui correspondent à une règle de la liste noire. Les violations détaillées sont enregistrées et les adresses IP sources peuvent faire l'objet d'une enquête plus approfondie.

Les autres événements de sécurité comprennent les escalades de privilèges, les processus suspects ou les activités anormales du système de fichiers détectées sur les conteneurs ou les hôtes.

*Rapports sur les risques*

L'analyse du registre, l'analyse de la durée d'exécution et les événements de contrôle d'admission sont affichés ici. Les résultats des contrôles de conformité et des critères d'évaluation du CIS seront également présentés.

Veuillez consulter la section Rapports pour plus de détails et pour connaître les limites de l'affichage des événements dans la console.

=== Paramètres

==== Paramètres -> Utilisateurs et rôles

Ajouter d'autres utilisateurs ici. Les utilisateurs peuvent se voir attribuer un rôle d'administrateur, un rôle en lecture seule ou un rôle personnalisé. Dans Kubernetes, les utilisateurs peuvent se voir attribuer un ou plusieurs espaces de noms auxquels accéder. Des rôles personnalisés peuvent également être configurés ici pour que les utilisateurs et les groupes (par exemple LDAP/AD) soient associés aux rôles. Voir la section xref:users.adoc[utilisateurs] pour les détails de configuration.

==== Paramètres -> Configuration

Configurez ici un nom de cluster unique, un nouveau mode de services et d'autres paramètres.

En cas de déploiement sur un cluster Rancher ou OpenShift, l'authentification peut être activée de sorte que les utilisateurs Rancher ou OpenShift puissent se connecter à la console {product-name} avec les RBAC associés. Pour les utilisateurs de Rancher, un bouton/lien de connexion depuis la console Rancher permet aux administrateurs de Rancher d'ouvrir et d'accéder directement à la console {product-name}.

Le xref:modes.adoc#_new_service_mode[nouveau mode de service] définit le mode de protection auquel les nouveaux services (applications) inconnus ou non définis sur {product-name} seront soumis par défaut. Pour les environnements de production, il n'est pas recommandé d'utiliser la valeur Discover.

Le mode xref:modes.adoc#_network_service_policy_mode[de politique de service réseau], s'il est activé, applique le mode de politique sélectionné globalement aux règles de réseau pour tous les groupes, et le mode de politique individuel de chaque groupe ne s'appliquera qu'aux règles de processus et de fichier.

La xref:modes.adoc#_automated_promotion_of_group_modes[promotion automatisée des modes de groupe] permet de promouvoir automatiquement le mode de protection d'un groupe (de Découvrir à Surveiller puis Protéger) en fonction du temps écoulé et des critères.

La suppression automatique des groupes inutilisés est utile pour le "nettoyage" automatisé des groupes découverts (et des règles créées automatiquement pour ces groupes) qui ne sont plus utilisés, en particulier dans les environnements de développement à forte rotation. Voir la politique -> Groupes pour la liste des groupes dans {product-name}. La suppression des groupes inutilisés permet de nettoyer la liste des groupes et toutes les règles associées à ces groupes.

L'option X-FORWARDED-FOR permet d'activer ou de désactiver l'utilisation de ces en-têtes dans le cadre de l'application des règles du réseau {product-name}. Cette fonction est utile pour conserver l'adresse IP source d'origine d'une connexion entrante afin qu'elle puisse être utilisée pour l'application des règles du réseau. Activer signifie que l'IP source sera conservée. Voir ci-dessous pour une explication détaillée.

Plusieurs webhooks peuvent être configurés pour être utilisés dans les xref:responserules.adoc[règles de réponse] pour des notifications personnalisées. Le format des webhooks peut être Slack, JSON ou des paires clé-valeur.

Un proxy de registre peut être configuré si la connexion d'analyse du registre entre le contrôleur et le registre doit passer par un proxy.

Configurer l'intégration SIEM via xref:reporting.adoc#_siem_and_syslog[SYSLOG], y compris les types d'événements, le port, etc. Vous pouvez également choisir d'envoyer les événements aux journaux des pods du contrôleur à la place ou en plus de syslog. Notez que ces événements ne seront envoyés qu'au journal du pod contrôleur principal (pas à tous les journaux des pods contrôleurs dans un déploiement multi-contrôleurs).

Une intégration avec xref:ibmsa.adoc[IBM Security Advisor] et xref:ibmqr.adoc[QRadar] peut être établie.

Importer/exporter le fichier de la politique de sécurité. Vous pouvez également configurer le SSO pour SAML et LDAP/AD ici. Voir la section Intégration à l'entreprise pour plus de détails sur la configuration. *_Important !_* Soyez prudent lors de l'importation du fichier de configuration. L'importation écrasera les paramètres existants. Si vous importez un fichier '`policy only`', les groupes et les règles de la politique seront écrasés. Si vous importez un fichier contenant des paramètres '`all`', la stratégie, les utilisateurs et les configurations seront écrasés. Notez que le mot de passe original de l'utilisateur '`admin`' de votre contrôleur actuel sera également remplacé par le mot de passe original de l'administrateur dans le fichier importé.

Les exportations du rapport d'utilisation et du journal de collecte peuvent être demandées par votre équipe d'assistance {product-name}.

===== X-FORWARDED-FOR Détails du comportement

Dans un cluster Kubernetes, une application peut être exposée à l'extérieur du cluster par un NodePort, un LoadBalancer ou des services Ingress. Ces services remplacent généralement l'IP source tout en effectuant le NAT de source (SNAT) sur les paquets. Comme l'IP source originale est masquée, cela empêche {product-name} de reconnaître que la connexion provient en fait de l'extérieur.

Afin de préserver l'adresse IP source d'origine, l'utilisateur doit ajouter la ligne suivante aux services exposés, dans la section "spec" de l'équilibreur de charge ou du contrôleur d'entrée orienté vers l'extérieur. (Réf : https://kubernetes.io/docs/tutorials/services/source-ip/)

[,json]
----
"externalTrafficPolicy":"Local"
----

De nombreuses implémentations de services LoadBalancer et de contrôleurs Ingress ajouteront la ligne X-FORWARDED-FOR à l'en-tête de la requête HTTP afin de communiquer l'adresse IP source réelle aux applications dorsales. Ce produit peut reconnaître cet ensemble d'en-têtes HTTP, identifier l'IP source d'origine et appliquer la politique en conséquence.

Cette amélioration a créé des problèmes inattendus dans certaines configurations. Si la ligne ci-dessus a été ajoutée aux services exposés et que les politiques de réseau {product-name} ont été créées de manière à s'attendre à ce que les connexions réseau proviennent de services proxy/ingress internes, parce que nous identifions maintenant que les connexions proviennent de l'extérieur du cluster, le trafic normal des applications peut déclencher des alertes ou être bloqué si les applications sont placées en mode "Protect".

Un interrupteur permet de désactiver cette fonction. Le fait de le désactiver indique à {product-name} de ne pas identifier que la connexion provient de "l'extérieur" à l'aide des en-têtes X-FORWARDED-FOR. Par défaut, cette fonction est activée et l'en-tête X-FORWARDED-FOR est utilisé pour l'application de la politique. Pour le désactiver, allez dans Paramètres -> Configuration, et désactivez le paramètre "X-Forwarded-For based policy match".

==== Paramètres -> LDAP/AD, SAML et OpenID Connect

{product-name} prend en charge l'intégration avec LDAP/AD, SAML et OpenID Connect pour le SSO et le mappage des groupes d'utilisateurs. Voir la section xref:integration.adoc[Intégration à l'entreprise] pour plus de détails sur la configuration.

==== Gestion de clusters multiples

Vous pouvez gérer xref:multicluster.adoc[plusieurs clusters {product-name} ] (par exemple, plusieurs clusters Kubernetes exécutant {product-name} sur différents clouds ou sur site) en sélectionnant un cluster maître et en y joignant des clusters distants. Chaque cluster distant peut également être géré individuellement. Les règles de sécurité peuvent être propagées à plusieurs clusters grâce à l'utilisation de paramètres de politique fédérée.

==== Mon profil

Vous pouvez augmenter le délai d'attente du navigateur, modifier votre mot de passe et procéder à d'autres modifications administratives du profil.

=== Description des icônes dans Légende > Activité du réseau

Vous pouvez activer ou désactiver la légende dans la boîte à outils de la carte d'activité du réseau.

image:4-3_NA_Legend.png[Légende]

Voici la signification des icônes :

==== Réseau externe

Il s'agit de tout réseau extérieur au cluster {product-name}. Il peut s'agir d'un accès public à l'internet ou d'autres réseaux internes.

==== Espace de noms

Espace de noms dans Kubernetes ou projet dans OpenShift

==== Maillage de groupes/conteneurs/services dans la découverte

Ce conteneur est en mode découverte, où les connexions vers/depuis lui sont apprises et des règles de liste blanche sont automatiquement créées.

==== Groupe/Conteneur/Service Mesh surveillé

Ce conteneur est en mode "surveillance", c'est-à-dire que les violations sont enregistrées mais ne sont pas bloquées.

==== Groupe/Conteneur/Service Mesh en cours de protection

Ce conteneur est en mode protection, où les violations seront bloquées.

==== Groupe des conteneurs

Il s'agit d'un groupe de conteneurs dans un service. Utilisez-le pour fournir une vue plus abstraite s'il existe de nombreuses instances de conteneurs pour un service/application (c'est-à-dire à partir de la même image).

==== Nœud non géré

Ce nœud a été détecté mais n'a pas d'exécuteur {product-name} sur lui.

==== Conteneur non géré

Ce conteneur a été détecté mais n'est pas sur un nœud avec un enforcer {product-name}. Il peut également s'agir de certains services du système.

==== Conteneur quitté

Ce conteneur n'est pas en cours d'exécution mais dans un état "quitté".

==== Groupe IP

Il s'agit d'un groupe d'adresses IP.

==== Conversation normale

Les connexions autorisées et inscrites sur la liste blanche sont affichées en bleu.

==== Conversation interne

Une connexion au sein d'un service est représentée en gris clair.

==== Conversation avec l'avertissement

Une connexion qui a généré une alerte de violation est indiquée en rouge plus clair.

==== La conversation est bloquée

Si une connexion constitue une violation, comme indiqué en rouge, et a été bloquée par {product-name}, la flèche comportera un '`x`'.

==== Conteneur mis en quarantaine

Les conteneurs entourés d'un cercle rouge ont été mis en quarantaine. Pour supprimer la quarantaine, cliquez avec le bouton droit de la souris sur le conteneur et sélectionnez le bouton Supprimer la quarantaine.
