= SAML (Azure AD)
:revdate: 2024-09-27
:page-revdate: {revdate}
:page-opendocs-origin: /08.integration/05.msazure/05.msazure.md
:page-opendocs-slug:  /integration/msazure

== Intégration avec l'authentification SAML Azure AD

. Dans la console de gestion Azure, sélectionnez l'élément de menu "Enterprise applications" dans Azure Active Directory.
+
image:azure1.png[azure_config1]

. Sélectionner &quot;`+New Application+`&quot;
+
image:azure2.png[azure_config2]

. Créez une application hors galerie et donnez-lui un nom unique.
+
image:azure3.png[azure_config3]

. Dans la page de configuration de l'application, sélectionnez "Single sign-on" dans le panneau de gauche et choisissez l'authentification basée sur SAML.
+
image:azure4.png[azure_config4]

. Téléchargez le certificat au format base64 et notez l'URL de connexion de l'application et l'identifiant Azure AD.
+
image:azure5.png[azure_config5]

. Dans la console de gestion {product-name}, connectez-vous en tant qu'administrateur. Sélectionnez "`Paramètres" dans le menu déroulant de l'administrateur situé dans le coin supérieur droit. Cliquez sur Paramètres SAML
+
image:azure6.png[azure_config6]

. Configurez le serveur SAML comme suit :
* Copier l'"URL de connexion" de l'application en tant qu'URL d'authentification unique.
* Copiez "Azure AD Identifier" en tant qu'émetteur.
* Ouvrez le certificat téléchargé et copiez le texte dans la boîte du certificat X.509.
* Définir un rôle par défaut.
* Saisissez le nom du groupe pour le mappage des rôles. Les demandes de groupe renvoyées par Azure sont identifiées par l'"Object ID" au lieu du nom. L'ID d'objet du groupe peut être trouvé sur menu:Azure Active[DirectoryGroups > name Page.] Vous devez utiliser cette valeur pour configurer le mappage des rôles basé sur les groupes dans {product-name}.
+
image:openid5.png[OpenID5]
+
Activez ensuite le serveur SAML.
+
image:azure7.png[azure_config7]

. Copier l'URL de redirection
+
image:azure8.png[azure_config8]

. Retournez à la console de gestion Azure pour configurer "Basic SAML Configuration". Copiez l'URL de redirection de la console {product-name} dans les cases "Identifiant" et "URL de réponse".
+
image:azure9.png[azure_config9]

. Modifier le "Certificat de signature SAML", en changeant l'option de signature en "Signer la réponse SAML".
+
image:azure10.png[azure_config10]

. Modifier "User Attributes & Claims" pour que la réponse puisse renvoyer les attributs de l'utilisateur connecté à {product-name}. Cliquez sur "Ajouter une nouvelle demande" pour ajouter les demandes "Nom d'utilisateur" et "Email" avec respectivement "user.userprincipalname" et "user.mail".
+
image:azure11.png[azure_config11]

. Si les utilisateurs sont affectés à des groupes dans le répertoire actif, leur appartenance à un groupe peut être ajoutée à la demande. Trouvez l'application dans "App registrations" et modifiez le manifeste. Modifier la valeur de "groupMembershipClaims" en "All".
+
image:azure12.png[azure_config12]

. Autoriser les utilisateurs et les groupes à accéder à l'application afin qu'ils puissent se connecter à la console {product-name} avec Azure AD SAML SSO
+
image:azure13.png[azure_config13]

=== Mappage des groupes aux rôles et aux espaces de noms

Veuillez consulter la section xref:users.adoc#_mapping_groups_to_roles_and_namespaces[Utilisateurs et rôles] pour savoir comment associer des groupes à des rôles prédéfinis et personnalisés ainsi qu'à des espaces de noms dans {product-name}.
