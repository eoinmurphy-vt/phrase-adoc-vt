= Gruppen
:revdate: 2024-09-27
:page-revdate: {revdate}
:page-opendocs-origin: /05.policy/04.groups/04.groups.md
:page-opendocs-slug:  /policy/groups

== Politik: Gruppen

Dieses Menü ist der wichtigste Bereich zum Anzeigen und Verwalten von Sicherheitsregeln und zum Anpassen von Gruppen für die Verwendung in Regeln. Sie wird auch verwendet, um zwischen den Gruppenmodi Entdecken, Überwachen und Schützen zu wechseln. Container-Gruppen können Prozess-/Dateiregeln in einem anderen Modus als Netzwerkregeln haben, wie xref:modes.adoc#_network_service_policy_mode[hier] beschrieben. In den folgenden Abschnitten finden Sie Erklärungen zu benutzerdefinierten Compliance-Checks, Netzwerkregeln, Prozess- und Dateizugriffsregeln sowie DLP/WAF-Erkennung. Anmerkung: Netzwerkregeln können im Menü Gruppen für jede Gruppe angezeigt werden, müssen aber separat im Menü xref:networkrules.adoc[Netzwerkregeln] bearbeitet werden.

{product-name} erstellt automatisch Gruppen aus Ihren laufenden Anwendungen. Diese Gruppen beginnen mit dem Präfix "nv". Sie können auch manuell über ein CRD oder die REST-API hinzugefügt werden und können in jedem Modus erstellt werden: Entdecken, Überwachen oder Schützen. Netzwerk- und Antwortregeln erfordern diese Gruppendefinitionen. Für automatisch erstellte Gruppen ("gelernte" Gruppen, die mit "nv" beginnen) lernt {product-name} das Netzwerk und die Prozessregeln und fügt sie im Erkennungsmodus hinzu. Benutzerdefinierte Gruppen lernen nicht automatisch und füllen keine Regeln aus. Hinweis: 'nv.'-Gruppen beginnen mit einer xref:processrules.adoc#_zero_drift_process_protection[Null-Drift], die standardmäßig für Prozess-/Dateischutz aktiviert ist.

image:5_groups.png[Gruppen]

Es ist praktisch, Gruppen von Containern zu sehen und Regeln auf jede Gruppe anzuwenden. {product-name} erstellt eine Liste von Gruppen basierend auf den Container-Images. Zum Beispiel werden alle Container, die von einem Wordpress-Image gestartet werden, in dieselbe Gruppe aufgenommen. Regeln werden automatisch erstellt und auf die Gruppe von Containern angewendet.

Auf dem Bildschirm "Gruppen" wird außerdem oben rechts das Symbol "Einlesbar" angezeigt, und eine gelernte Gruppe kann ausgewählt und das Kontrollkästchen "Einlesbar" aktiviert oder deaktiviert werden. Hier wird festgelegt, welche Container für die Berechnung des Sicherheitsrisikos im Dashboard verwendet werden. Weitere Informationen finden Sie unter xref:improve-score.adoc#_improving_the_security_risk_score[Sicherheitsrisikobewertung verbessern].

Über den Bildschirm Gruppen kann auch die CRD-Yaml-Datei für "Sicherheitsrichtlinien als Code" importiert und exportiert werden. Wählen Sie eine oder mehrere Gruppen aus und klicken Sie auf die Schaltfläche Gruppenrichtlinie exportieren, um die yaml-Datei herunterzuladen. Weitere Einzelheiten zur Verwendung von xref:usingcrd.adoc[CRDs] finden Sie im Abschnitt xref:usingcrd.adoc[CRDs]. Das ist wichtig: Jede ausgewählte Gruppe UND alle über Netzwerkregeln verknüpften Gruppen werden exportiert (d. h. die Gruppe und alle anderen Gruppen, mit denen sie über die Whitelist-Netzwerkregeln verbunden ist).

=== Automatisches Löschen von nicht verwendeten Gruppen

Gelernte Gruppen (nicht reservierte oder benutzerdefinierte Gruppen) können automatisch von {product-name} gelöscht werden, wenn es keine Mitglieder (Container) in der Gruppe gibt. Die Zeitspanne hierfür ist unter Einstellungen -> Konfiguration konfigurierbar.

=== Host-Schutz - die Gruppe "Nodes

{product-name} erstellt automatisch eine Gruppe namens "Nodes", die jeden Knoten (Host) im Cluster repräsentiert. {product-name} bietet eine automatische Basisüberwachung von Hosts auf verdächtige Prozesse (wie Port-Scans, Reverse Shells usw.) und Privilegienerweiterungen. Darüber hinaus lernt {product-name} das Prozessverhalten jedes Knotens, während er sich im Erkennungsmodus befindet, um diese Prozesse auf eine Whitelist zu setzen, ähnlich wie es bei Containerprozessen der Fall ist.  Die "lokale" (gelernte) Prozessregel-Liste ist eine Kombination aller Prozesse von allen Knoten im Cluster im Erkennungsmodus.

Die Knoten können dann in den Überwachungs- oder Schutzmodus versetzt werden, wobei {product-name} eine Warnung ausgibt, wenn ein Prozess im Überwachungsmodus startet, und diesen Prozess im Schutzmodus blockiert.

image:host_protection.png[nodeGroup]

Um den Host-Schutz mit Prozessprofilregeln zu aktivieren, wählen Sie die Gruppe "Knoten" und überprüfen Sie die gelernten Prozesse auf dem Knoten. Passen Sie das System bei Bedarf an, indem Sie Prozessregeln hinzufügen, löschen oder bearbeiten. Schalten Sie dann den Modus auf "Überwachen" oder "Schützen" um.

[NOTE]
====
Netzwerkverbindungen, die gegen die in den Netzwerkregeln für Knoten aufgeführten Regeln verstoßen, werden auch im Schutzmodus nicht blockiert. Im Schutzmodus werden auf Knoten nur Prozessverletzungen blockiert.
====

=== Benutzerdefinierte Gruppen

Gruppen können manuell hinzugefügt werden, indem die Kriterien für die Gruppe eingegeben werden. Anmerkung: Benutzerdefiniert erstellte Gruppen haben keinen Schutzmodus. Dies liegt daran, dass sie Container aus verschiedenen zugrunde liegenden Gruppen enthalten können, die sich jeweils in einem anderen Modus befinden können, was zu Verwirrung über das Verhalten führt.

Gruppen können erstellt werden durch:

* *Bilder*
+
____
Wählen Sie Container anhand ihrer Bildnamen aus. Beispiele: image=wordpress, image@redis
____

* *Knotenpunkte*
+
____
Auswahl von Containern nach Knoten, auf denen sie laufen. Examples: node=ip-12-34-56-78.us-west-2
____

* *Einzelne Behälter*
+
____
Wählen Sie Container anhand ihrer Instanznamen aus. Beispiele: container=nodejs_1, container@nodejs
____

* *Dienstleistungen*
+
____
Wählen Sie die Container nach ihren Leistungen aus. Wenn ein Container von Docker Compose bereitgestellt wird, lautet sein Service-Tag-Wert "project_name:service_name"; wenn ein Container von einem Docker-Swarm-Modus-Dienst bereitgestellt wird, lautet sein Service-Tag-Wert der Name des Swarm-Dienstes.
____

* *Etiketten*
+
____
Wählen Sie die Behälter anhand ihrer Etiketten aus. Beispiele: com.docker.compose.project=wordpress, Standort@us-west
____

* *Adressen*
+
____
Erstellen Sie eine Gruppe nach DNS-Namen oder IP-Adressbereichen. Beispiele: address=www.google.com, address=10.1.0.1, address=10.1.0.0/24, address=10.1.0.1-10.1.0.25. Der DNS-Name kann ein beliebiger auflösbarer Name sein. Adresskriterien akzeptieren den Operator != nicht. Siehe unten für spezielle virtuelle Host-'vh'-Adressgruppen.
____

Eine Gruppe kann mit gemischten Kriterientypen erstellt werden, mit Ausnahme des Typs "Adresse", der nicht zusammen mit anderen Kriterien verwendet werden kann. Gemischte Kriterien erzwingen eine &apos;`+AND+`&apos; Operation zwischen den Kriterien, z. B. label service_type=data AND image=mysql. Mehrere Einträge für ein oder mehrere Kriterien werden als OR behandelt, zum Beispiel address=google.com OR address=yahoo.com. Anmerkung: Um die Analyse von Ingress/Egress-Verbindungen zu unterstützen, kann eine Liste der Ingress- und Egress-IPs aus dem Dashboard -> Ingress/Egress-Details als Exposure-Bericht heruntergeladen werden.

Teilweise Übereinstimmung wird für Bild-, Knoten-, Container-, Service- und Label-Kriterien unterstützt. Beispiel: image@redis wählt Container aus, deren Bildname die Teilzeichenkette "redis" enthält; image{caret}redis wählt Container aus, deren Bildname mit "redis" beginnt.

Es wird nicht empfohlen, Adresskriterien zu verwenden, um interne IPs oder Subnetze abzugleichen, insbesondere solche, die von Enforcern geschützt werden; stattdessen wird empfohlen, ihre Metadaten zu verwenden, z. B. Bild, Dienst oder Labels. Die typischen Anwendungsfälle für Adressgruppen sind die Definition von Richtlinien zwischen verwalteten Containern und externen IP-Subnetzen, z. B. Diensten, die im Internet oder in einem anderen Rechenzentrum laufen. Die Adressgruppe hat keine Gruppenmitglieder.

Platzhalter_'' können in den Kriterien verwendet werden, zum Beispiel 'address=_.google.com'. Für einen flexibleren Abgleich verwenden Sie die Tilde '~', um anzugeben, dass eine Regex-Übereinstimmung gewünscht ist. Zum Beispiel, um Etiketten 'policy~public.*-ext1' für die Label-Richtlinie zu finden.

[NOTE]
====
Sonderzeichen, die nach einem Gleichheitszeichen '=' in Kriterien verwendet werden, werden möglicherweise nicht richtig zugeordnet. Zum Beispiel der Punkt '.' In 'policy=public._' wird nicht richtig übereinstimmen, und stattdessen sollte eine Regex-Übereinstimmung verwendet werden, wie 'policy~public._'
====

Nachdem Sie eine neue Gruppe gespeichert haben, zeigt {product-name} die Mitglieder dieser Gruppe an. Anhand dieser Gruppen können dann Regeln erstellt werden.

==== Auf virtuellen Hosts ('vh') basierende Netzwerkpolitik

Benutzerdefinierte Gruppen können auf virtuellen Hosts basierende Adressgruppen unterstützen. Dies ermöglicht einen Anwendungsfall, bei dem zwei verschiedene FQDN-Adressen in dieselbe IP-Adresse aufgelöst werden, aber unterschiedliche Regeln für jeden FQDN durchgesetzt werden sollen. Eine neue benutzerdefinierte Gruppe mit &apos;`+address=vh:xxx.yyy+`&apos; kann mit dem Kennzeichen &apos;`+vh:+`&apos; erstellt werden, um diesen Schutz zu aktivieren. Eine Netzwerkregel kann dann die benutzerdefinierte Gruppe als &apos;`+From+`&apos; Quelle basierend auf dem virtuellen Hostnamen (anstelle der aufgelösten IP-Adresse) verwenden, um unterschiedliche Regeln für virtuelle Hosts durchzusetzen.

== Beispiele für benutzerdefinierte Gruppen

=== Allgemeine Kriterien

* So wählen Sie alle Container aus (jedes der folgenden Beispiele funktioniert)
+
____
container=&lowast;service=&lowast;
____

* So wählen Sie alle Container im Namensraum 'default' aus (Namensraum unterstützt ab v2.2)
+
____
namespace=default
____

* So wählen Sie alle Container aus, deren Dienstname mit "nginx" beginnt
+
____
service=nginx&lowast;
____

* So wählen Sie alle Container aus, deren Dienstname "etcd" enthält
+
____
dienst=&lowast;etcd&lowast;
____

* So wählen Sie alle Container im Namensraum 'apache1' oder 'apache2' aus (drücken Sie nach jedem Eintrag die Eingabetaste)
+
____
namespace=apache1 namespace=apache2
____

* So wählen Sie alle Container aus, die sich NICHT im Namensraum 'apache1' und 'apache2' befinden (drücken Sie nach jedem Eintrag die Eingabetaste)
+
____
namespace!=apache1 namespace!=apache2
____

* So wählen Sie alle Container im Namespace 'apache1~9' aus
+
____
namespace~apache[1-9]
____

=== Kriterien für die IP-Adresse

* Alle externen IP-Adressen
+
____
Bitte verwenden Sie die Standardgruppe &apos;`+external+`&apos; in den Regeln.
____

* IP-Teilnetz 10.0.0.0/8
+
____
address=10.0.0.0/8
____

* IP-Bereich
+
____
address=10.0.0.0-10.0.0.15
____

* dropbox.com und seine Subdomains (nach jedem Eintrag Enter drücken)
+
____
address=dropbox.com address=*.dropbox.com
____
